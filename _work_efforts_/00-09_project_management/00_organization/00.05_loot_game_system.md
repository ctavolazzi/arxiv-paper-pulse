# Work Effort: ArXiv Paper Loot-Based Game System

## Status: In Progress
**Started:** 2025-11-01 20:58
**Last Updated:** 2025-11-01 20:58

## Objective
Create a modular, containerized loot-based game system that transforms ArXiv papers into collectible game items with visual representations. The system will build iteratively, one layer at a time, using:
- Existing ArXiv paper parsing infrastructure
- Gemini API for text analysis and image generation
- Modular, composable components that build on each other
- Game mechanics tied to paper properties (rarity, categories, impact, etc.)

## Vision
Each ArXiv paper becomes a "loot item" in the game:
- Papers have game properties: rarity, stats, categories, visual cards
- Images are generated for each paper using Gemini's image generation API
- Players "collect" papers by processing them
- Papers can be upgraded, combined, or used in various game mechanics

## Architecture Layers (Build Order)

### Layer 1: Image Generation Module
**Goal:** Standalone, reusable image generation component
- Wrapper around Gemini 2.5-flash-image-preview model
- Generate images from text prompts
- Support for image editing and style transfer
- Simple interface that can be used by any component

### Layer 2: Paper-to-Loot Converter
**Goal:** Transform paper data into game item data
- Extract game-relevant properties from papers (title, abstract, category, etc.)
- Calculate rarity based on paper characteristics
- Generate game stats from paper metadata
- Output structured loot item data

### Layer 3: Loot Visual Generator
**Goal:** Generate visual cards for loot items
- Use Layer 1 (image generation) to create paper card images
- Combine paper data with visual design prompts
- Generate consistent card style with paper-specific customization

### Layer 4: Game Mechanics Engine
**Goal:** Core game logic and rules
- Player inventory system
- Collection tracking
- Loot drop mechanics
- Upgrade/combination systems

### Layer 5: Frontend Integration
**Goal:** Game UI that displays loot items
- Visual card gallery
- Collection view
- Loot opening animations
- Game progression UI

## Tasks

### Phase 1: Foundation (Layer 1) ✅ COMPLETE
- [x] Create `arxiv_paper_pulse/image_generator.py` module
- [x] Implement text-to-image generation
- [x] Add image editing capabilities
- [x] Create simple API endpoint for image generation
- [x] Add Pillow dependency to pyproject.toml
- [x] Add configuration support (IMAGE_OUTPUT_DIR)
- [x] Create comprehensive test suite (test_image_generator.py)
- [x] Set up `generated_images/` directory with README
- [x] Update API endpoint to use config directory

### Phase 2: Paper Processing (Layer 2)
- [ ] Create `arxiv_paper_pulse/loot_converter.py` module
- [ ] Extract paper properties for game mechanics
- [ ] Implement rarity calculation algorithm
- [ ] Generate game stats from paper metadata
- [ ] Test conversion with real papers

### Phase 3: Visual Generation (Layer 3)
- [ ] Integrate Layer 1 and Layer 2
- [ ] Create card generation prompts
- [ ] Generate first loot card image
- [ ] Implement card style consistency
- [ ] Test with multiple papers

### Phase 4: Game Engine (Layer 4)
- [ ] Create `arxiv_paper_pulse/game_engine.py` module
- [ ] Implement inventory system
- [ ] Add collection tracking
- [ ] Create loot drop mechanics
- [ ] Add upgrade systems

### Phase 5: Frontend (Layer 5)
- [ ] Design game UI components
- [ ] Integrate with backend API
- [ ] Display loot cards
- [ ] Add game interactions
- [ ] Implement progression tracking

## Technical Requirements

### Image Generation
- Model: `gemini-2.5-flash-image-preview`
- Support text-to-image, image editing, style transfer
- Handle base64 image encoding/decoding
- Store generated images appropriately

### Loot System
- Each paper becomes a unique loot item
- Properties: rarity (common/rare/epic/legendary), stats, category, visual card
- Rarity calculation based on: paper category, publication date, author count, abstract length, citations (if available)

### Modularity
- Each layer is independent and testable
- Layers can be used standalone or composed
- Clean interfaces between layers
- No circular dependencies

## Progress

### Layer 1: Image Generation Module ✅ COMPLETE

**Files Created:**
- `arxiv_paper_pulse/image_generator.py` - Standalone image generation module

**Files Modified:**
- `arxiv_paper_pulse/api.py` - Added `/api/generate-image` endpoint
- `pyproject.toml` - Added `pillow` dependency

**Implementation:**
- `ImageGenerator` class with direct interface
- `generate_from_text()` - Text-to-image generation
- `generate_from_text_and_image()` - Image editing
- `generate_and_save()` - Convenience method for generation + saving
- `save_image()` - Enhanced with auto-filename generation
- Configuration-driven output directory (`IMAGE_OUTPUT_DIR`)
- API endpoint accepts prompt and returns saved image path

**Test Suite:**
- `tests/test_image_generator.py` - Comprehensive test coverage
  - Initialization tests (default/custom config)
  - Text-to-image generation tests
  - Image editing tests
  - Save functionality tests
  - Integration workflow tests
  - Directory structure verification tests

**Directory Structure:**
- All images saved to: `arxiv_paper_pulse/data/generated_images/`
- README.md explains purpose and usage
- Clearly labeled and easy to find

### Current Status
Layer 1 complete. Ready to proceed to Layer 2: Paper-to-Loot Converter

## Next Steps
1. Test Layer 1 with sample prompts
2. Create `loot_converter.py` module for Layer 2
3. Implement paper property extraction
4. Add rarity calculation algorithm

## Notes
- Following direct & minimal Python style guide
- No unnecessary abstractions
- Build iteratively, test each layer
- Use existing Gemini API configuration

